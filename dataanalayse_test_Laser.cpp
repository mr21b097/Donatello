#include <iostream>
#include <string>
#include <regex>
#include <vector>

int main() {
    std::string input = R"(---START---{"header": {"seq": 22217, "stamp": {"secs": 1706294554, "nsecs": 63001548}, "frame_id": "base_scan"}, "angle_min": 0.0, "angle_max": 6.2657318115234375, "angle_increment": 0.01745329238474369, "time_increment": 0.0005592841189354658, "scan_time": 0.20134228467941284, "range_min": 0.11999999731779099, "range_max": 3.5, "ranges": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6169999837875366, 0.753000020980835, 0.0, 2.9639999866485596, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8840000033378601, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.30000001192092896, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3380000591278076, 1.315999984741211, 1.2760000228881836, 1.2319999933242798, 1.2139999866485596, 1.2070000171661377, 1.1649999618530273, 1.1490000486373901, 1.1480000019073486, 1.121999979019165, 1.1119999885559082, 1.100000023841858, 1.1030000448226929, 1.0709999799728394, 1.065999984741211, 1.1330000162124634, 1.1030000448226929, 1.190000057220459, 1.2170000076293945, 0.9319999814033508, 0.9319999814033508, 0.9520000219345093, 0.9539999961853027, 0.9620000123977661, 0.9559999704360962, 1.034999966621399, 0.9660000205039978, 0.9660000205039978, 0.9660000205039978, 0.949999988079071, 0.949999988079071, 0.9639999866485596, 0.9570000171661377, 0.9430000185966492, 0.9259999990463257, 0.8889999985694885, 0.8730000257492065, 0.8629999756813049, 0.843999981880188, 0.8309999704360962, 0.796999990940094, 0.7879999876022339, 0.781000018119812, 0.7770000100135803, 0.765999972820282, 0.753000020980835, 0.5680000185966492, 0.5600000023841858, 0.5529999732971191, 0.5519999861717224, 0.5519999861717224, 0.5550000071525574, 0.5600000023841858, 0.5680000185966492, 0.5770000219345093, 0.5870000123977661, 0.5979999899864197, 0.6110000014305115, 0.621999979019165, 0.6320000290870667, 1.0789999961853027, 0.0, 0.9879999756813049, 0.9729999899864197, 0.9589999914169312, 0.9490000009536743, 0.8790000081062317, 0.9229999780654907, 0.8140000104904175, 0.8289999961853027, 0.8560000061988831, 0.7639999985694885, 0.8220000267028809, 0.8339999914169312, 0.9279999732971191, 0.9449999928474426, 0.0, 2.0329999923706055, 2.0789999961853027, 2.0859999656677246, 0.8700000047683716, 0.8700000047683716, 0.8730000257492065, 0.871999979019165, 0.8550000190734863, 0.8650000095367432, 0.8820000290870667, 0.8830000162124634, 0.871999979019165, 0.8619999885559082, 0.8669999837875366, 0.8460000157356262, 0.8360000252723694, 0.8479999899864197, 0.8659999966621399, 0.859000027179718, 0.8579999804496765, 0.875, 0.875, 0.8790000081062317, 0.8799999952316284, 0.9010000228881836, 0.8920000195503235, 0.9139999747276306, 0.9089999794960022, 0.9120000004768372, 0.9290000200271606, 0.921999990940094, 0.9779999852180481, 3.1440000534057617, 3.191999912261963, 3.1470000743865967, 3.2809998989105225, 3.367000102996826, 3.447000026702881, 3.4489998817443848, 3.5360000133514404, 3.5250000953674316, 3.678999900817871, 3.812000036239624, 3.818000078201294, 3.882999897003174, 4.138999938964844, 0.0, 0.0, 4.151000022888184, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1599999964237213, 0.21199999749660492, 0.21199999749660492, 0.20399999618530273, 0.21699999272823334, 0.21699999272823334, 0.21799999475479126, 0.23100000619888306, 0.23600000143051147, 0.24199999868869781, 0.25600001215934753, 0.25600001215934753, 0.25699999928474426, 0.26100000739097595, 0.0, 0.0, 0.23399999737739563, 0.0, 0.0, 0.0, 0.3269999921321869, 0.3330000042915344, 0.33899998664855957, 0.34299999475479126, 0.34599998593330383, 0.35100001096725464, 0.3569999933242798, 0.37400001287460327, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.878999948501587, 1.8109999895095825, 1.8380000591278076, 1.8880000114440918, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09399999678134918, 0.09399999678134918, 0.0949999988079071, 0.09399999678134918, 0.09300000220537186, 0.09200000017881393, 0.09099999815225601, 0.0, 0.0], "intensities": [0.0, 0.0, 47.0, 0.0, 48.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3278.0, 278.0, 147.0, 102.0, 143.0, 0.0, 0.0, 0.0, 0.0, 62.0, 0.0, 0.0, 1808.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 2270.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 48.0, 52.0, 767.0, 908.0, 1110.0, 1147.0, 981.0, 1004.0, 1882.0, 1856.0, 1969.0, 1799.0, 1362.0, 1323.0, 1544.0, 1576.0, 1555.0, 1413.0, 1049.0, 771.0, 476.0, 718.0, 1369.0, 1570.0, 1707.0, 1741.0, 1598.0, 1201.0, 995.0, 2311.0, 1706.0, 2322.0, 1814.0, 2211.0, 2521.0, 1158.0, 2427.0, 2594.0, 2811.0, 2846.0, 3320.0, 1885.0, 2750.0, 3164.0, 3238.0, 3077.0, 2697.0, 2058.0, 2725.0, 3500.0, 3953.0, 4085.0, 3758.0, 4047.0, 4026.0, 3735.0, 3607.0, 4149.0, 4061.0, 3745.0, 4263.0, 1829.0, 472.0, 125.0, 324.0, 135.0, 248.0, 299.0, 308.0, 442.0, 485.0, 533.0, 530.0, 587.0, 601.0, 587.0, 496.0, 306.0, 0.0, 469.0, 457.0, 412.0, 888.0, 1713.0, 2358.0, 3017.0, 2853.0, 1739.0, 3189.0, 2123.0, 2721.0, 3037.0, 3018.0, 2845.0, 2736.0, 2228.0, 2097.0, 2963.0, 1718.0, 3209.0, 2656.0, 3005.0, 2816.0, 2679.0, 2539.0, 1822.0, 2260.0, 3008.0, 2662.0, 2900.0, 662.0, 303.0, 296.0, 304.0, 290.0, 281.0, 278.0, 281.0, 273.0, 267.0, 252.0, 244.0, 242.0, 233.0, 123.0, 258.0, 356.0, 320.0, 129.0, 122.0, 319.0, 0.0, 0.0, 1194.0, 939.0, 1071.0, 1290.0, 1324.0, 1125.0, 1255.0, 1125.0, 1197.0, 940.0, 254.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 49.0, 345.0, 5391.0, 12757.0, 6868.0, 6569.0, 7572.0, 7190.0, 2503.0, 6541.0, 6510.0, 5765.0, 3708.0, 3537.0, 5298.0, 0.0, 0.0, 2090.0, 151.0, 183.0, 39.0, 1437.0, 1605.0, 1495.0, 1094.0, 902.0, 790.0, 382.0, 107.0, 81.0, 0.0, 0.0, 0.0, 181.0, 177.0, 173.0, 166.0, 164.0, 156.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 64.0, 75.0, 71.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 138.0, 153.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 53.0, 69.0, 82.0, 107.0, 293.0, 324.0, 329.0, 317.0, 311.0, 242.0, 259.0, 234.0, 101.0, 134.0, 89.0, 84.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 105.0, 45.0, 77.0, 74.0, 49.0, 61.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 105.0, 2095.0, 1957.0, 1995.0, 2246.0, 2305.0, 2255.0, 3861.0, 54.0]}___END___)";

    // Marker definitions
    std::string startMarker = "---START---";
    std::string endMarker = "___END___";

    // Check if both markers exist
    size_t startPos = input.find(startMarker);
    size_t endPos = input.find(endMarker);

    if (startPos != std::string::npos && endPos != std::string::npos) {
        // Extract the data between markers
        startPos += startMarker.length();
        std::string jsonData = input.substr(startPos, endPos - startPos);

        // Find the ranges array in the JSON data
        std::regex rangesRegex("\"ranges\":\\s*\\[(.*?)\\]");
        std::smatch matches;
        if (std::regex_search(jsonData, matches, rangesRegex)) {
            std::string rangesString = matches[1].str();

            // Parse the ranges into a vector
            std::vector<float> ranges;
            std::regex numberRegex("-?\\d+(\\.\\d+)?");
            auto numbersBegin = std::sregex_iterator(rangesString.begin(), rangesString.end(), numberRegex);
            auto numbersEnd = std::sregex_iterator();

            for (std::sregex_iterator i = numbersBegin; i != numbersEnd; ++i) {
                ranges.push_back(std::stof((*i).str()));
            }

            // Check if the ranges array has exactly 360 values
            if (ranges.size() == 360) {
                std::cout << "Extracted ranges:" << std::endl;
                for (float range : ranges) {
                    std::cout << range << " ";
                }
                std::cout << std::endl;
            } else {
                std::cout << "Error: Ranges array does not contain exactly 360 values. Found: " << ranges.size() << std::endl;
            }
        } else {
            std::cout << "Ranges array not found in the JSON data." << std::endl;
        }
    } else {
        std::cout << "Markers not found in the input string." << std::endl;
    }

    return 0;
}
